<h1><%= @survey.title %></h1>

<%= form_with model: [@survey, response] do |form| %>
    <%= form.fields_for :answers do |response| %>
    <% @survey.questions.each do |question| %>
    <div class="q">
        <h2>
            <%= question.title %>
            <%= content_tag :abbr, '*', title: 'Required' if question.required %>
        <h2>

    <% case question.question_type %>
    <% when 'single_choice' %>
        <% question.answers.each do |answer| %>
            <p>
                <%= response.radio_button question.id, answer.id, required: question.required %>
                <%= answer.title %>
            </p>
        <% end %>
    <% when 'multiple_choice' %>
        <% question.answers.each do |answer| %>
            <p>
                <%= response.check_box question.id, { multiple: true }, answer.id %>
                <%= answer.title %>
            </p>
        <% end %>
    <% when 'long_answer' %>
        <%= response.text_area question.id, required: question.required %>
    <% when 'satisfaction' %>
        <table>
            <tr>
                <% question.answers.each do |answer| %>
                    <td>
                        <%= answer.title %>
                    </td>
                <% end %>
            </tr>
            <tr>
                <% question.answers.each do |answer| %>
                    <td>
                        <%= response.radio_button question.id, answer.id %>
                    </td>
                <% end %>
            </tr>
        </table> 
    <% when 'date' %>
        <%= response.date_field question.id %>
    <% when 'time' %>
        <%= time_field_tag question.id %>
    <% when 'drop_down_menu' %>
        <%= select_tag question.id, options_for_select(question.answers.collect{ |o| [o.title, o.id] }) %>
    
    <% when 'range' %>
        <%= range_field_tag question.id %>  
    <% when 'file' %>
        <%= file_field_tag question.id, accept: "application/pdf, application/zip", multiple: true %>  
    <% when 'image' %>
    <%= file_field_tag question.id %>  
        <% question.answers.each do |answer| %>
            <%= image_tag answer.answerimg.variant(resize_to_limit: [200, 300]) %>  
        <% end %>
    </div>
    <% end %>



    <% end %>
  <% end %>

  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>